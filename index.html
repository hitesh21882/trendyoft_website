<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trendyoft - Modern Lifestyle Store</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">Trendyoft</div>
            <div class="nav-menu">
                <a href="#" class="nav-link active" data-page="home">Home</a>
                <a href="#" class="nav-link" data-page="return-policy">Return Policy</a>
                <a href="#" class="nav-link" data-page="reviews">Reviews</a>
                <a href="#" class="nav-link" data-page="login">Login</a>
                <a href="#" class="nav-link" data-page="checkout">Checkout</a>
            </div>
            <div class="nav-actions">
                <button class="search-btn" onclick="toggleSearch()">üîç</button>
                <button class="cart-btn" onclick="showPage('cart')">üõí <span id="cart-count" class="cart-count">0</span></button>
            </div>
        </div>
    </nav>

    <!-- Search Modal -->
    <div id="search-modal" class="search-modal">
        <div class="search-modal-content">
            <div class="search-header">
                <input type="text" id="search-input" placeholder="Search for products..." autocomplete="off">
                <button class="close-search" onclick="toggleSearch()">√ó</button>
            </div>
            <div id="search-results" class="search-results">
                <div class="search-suggestions">
                    <p>Try searching for: "Striped", "Mountain", "Green", "Coral"</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Home Page -->
    <section id="home" class="page active">
        <!-- Hero Section -->
        <div class="hero">
            <div class="hero-background">
                <div class="landscape">
                    <div class="mountains">
                        <div class="mountain mountain-1"></div>
                        <div class="mountain mountain-2"></div>
                        <div class="mountain mountain-3"></div>
                    </div>
                    <div class="trees">
                        <div class="tree tree-1"></div>
                        <div class="tree tree-2"></div>
                        <div class="tree tree-3"></div>
                        <div class="tree tree-4"></div>
                        <div class="tree tree-5"></div>
                    </div>
                    <div class="people">
                        <div class="person person-1"></div>
                        <div class="person person-2"></div>
                    </div>
                </div>
            </div>
            <div class="hero-content">
                <h1>We find the coolest, most talked-about products on the internet and bring them straight to your doorstep</h1>
                <button class="cta-button" onclick="showPage('shop')">Shop all</button>
            </div>
        </div>

        <!-- Featured Products -->
        <div class="featured-section">
            <div class="container">
                <h2>Trending products</h2>
                <div class="products-scroll-container">
                    <button class="scroll-btn scroll-left" onclick="scrollProducts('left')">
                        <span>‚Äπ</span>
                    </button>
                    <div class="products-grid" id="products-grid">
                        <div class="product-card">
                            <div class="product-image product-1" onclick="viewProductDetails('Striped Adventure Tee')"></div>
                            <h3 onclick="viewProductDetails('Striped Adventure Tee')">Striped Adventure Tee</h3>
                            <p class="price">Rs. 19.99</p>
                            <button class="add-to-cart">Add to Cart</button>
                        </div>
                        <div class="product-card">
                            <div class="product-image product-2" onclick="viewProductDetails('Mountain Sunset Shirt')"></div>
                            <h3 onclick="viewProductDetails('Mountain Sunset Shirt')">Mountain Sunset Shirt</h3>
                            <p class="price">Rs. 19.99</p>
                            <button class="add-to-cart">Add to Cart</button>
                        </div>
                        <div class="product-card">
                            <div class="product-image product-3" onclick="viewProductDetails('Forest Green Classic')"></div>
                            <h3 onclick="viewProductDetails('Forest Green Classic')">Forest Green Classic</h3>
                            <p class="price">Rs. 19.99</p>
                            <button class="add-to-cart">Add to Cart</button>
                        </div>
                        <div class="product-card">
                            <div class="product-image product-4" onclick="viewProductDetails('Coral Comfort Tee')"></div>
                            <h3 onclick="viewProductDetails('Coral Comfort Tee')">Coral Comfort Tee</h3>
                            <p class="price">Rs. 19.99</p>
                            <button class="add-to-cart">Add to Cart</button>
                        </div>
                    </div>
                    <button class="scroll-btn scroll-right" onclick="scrollProducts('right')">
                        <span>‚Ä∫</span>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Login Page -->
    <section id="login" class="page">
        <div class="container">
            <div class="form-container">
                <div class="form-header">
                    <h2>Welcome Back</h2>
                    <p>Sign in to your account</p>
                </div>
                <form class="login-form">
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" name="password" required>
                    </div>
                    <div class="form-options">
                        <label class="checkbox-label">
                            <input type="checkbox" name="remember">
                            <span class="checkmark"></span>
                            Remember me
                        </label>
                        <a href="#" class="forgot-password">Forgot password?</a>
                    </div>
                    <button type="submit" class="form-button">Sign In</button>
                    <div class="form-footer">
                        <p>Don't have an account? <a href="#">Sign up</a></p>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Checkout Page -->
    <section id="checkout" class="page">
        <div class="container">
            <div class="checkout-container">
                <div class="checkout-form">
                    <h2>Checkout</h2>
                    <form class="checkout-form-content">
                        <div class="form-section">
                            <h3>Shipping Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="firstName">First Name</label>
                                    <input type="text" id="firstName" name="firstName" required>
                                </div>
                                <div class="form-group">
                                    <label for="lastName">Last Name</label>
                                    <input type="text" id="lastName" name="lastName" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="email">Email Address</label>
                                <input type="email" id="email" name="email" placeholder="your@email.com" required>
                            </div>
                            <div class="form-group">
                                <label for="phoneNumber">Phone Number</label>
                                <input type="tel" id="phoneNumber" name="phoneNumber" placeholder="+1 (555) 123-4567" required>
                            </div>
                            <div class="form-group">
                                <label for="address">Address</label>
                                <input type="text" id="address" name="address" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="city">City</label>
                                    <input type="text" id="city" name="city" required>
                                </div>
                                <div class="form-group">
                                    <label for="country">Country/Region</label>
                                    <select id="country" name="country" required>
                                        <option value="">Select Country</option>
                                        <option value="us">United States</option>
                                        <option value="ca">Canada</option>
                                        <option value="uk">United Kingdom</option>
                                        <option value="de">Germany</option>
                                        <option value="fr">France</option>
                                        <option value="it">Italy</option>
                                        <option value="es">Spain</option>
                                        <option value="nl">Netherlands</option>
                                        <option value="be">Belgium</option>
                                        <option value="ch">Switzerland</option>
                                        <option value="au">Australia</option>
                                        <option value="nz">New Zealand</option>
                                        <option value="jp">Japan</option>
                                        <option value="kr">South Korea</option>
                                        <option value="sg">Singapore</option>
                                        <option value="hk">Hong Kong</option>
                                        <option value="ae">UAE</option>
                                        <option value="sa">Saudi Arabia</option>
                                        <option value="in">India</option>
                                        <option value="pk">Pakistan</option>
                                        <option value="bd">Bangladesh</option>
                                        <option value="mx">Mexico</option>
                                        <option value="br">Brazil</option>
                                        <option value="ar">Argentina</option>
                                        <option value="za">South Africa</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="zipCode">ZIP/Postal Code</label>
                                    <input type="text" id="zipCode" name="zipCode" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="deliveryInstructions">Delivery Instructions</label>
                                <textarea id="deliveryInstructions" name="deliveryInstructions" rows="3" placeholder="Do we need additional instructions to find this address? (e.g., apartment number, building name, landmarks, gate code, etc.)"></textarea>
                            </div>
                        </div>

                        <div class="form-section">
                            <h3>Payment Information</h3>
                            <div class="form-group">
                                <label for="cardNumber">Card Number</label>
                                <input type="text" id="cardNumber" name="cardNumber" placeholder="1234 5678 9012 3456" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="expiryDate">Expiry Date</label>
                                    <input type="text" id="expiryDate" name="expiryDate" placeholder="MM/YY" required>
                                </div>
                                <div class="form-group">
                                    <label for="cvv">CVV</label>
                                    <input type="text" id="cvv" name="cvv" placeholder="123" required>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="form-button" onclick="placeOrder(event)">Place Order</button>
                    </form>
                </div>

                <div class="order-summary">
                    <h3>Order Summary</h3>
                    <div id="checkout-items" class="checkout-items">
                        <!-- Cart items will be displayed here -->
                    </div>
                    <div id="checkout-empty" class="checkout-empty" style="display: none;">
                        <p>Your cart is empty</p>
                        <button class="form-button" onclick="showPage('home')">Continue Shopping</button>
                    </div>
                    <div id="checkout-summary" class="checkout-summary" style="display: none;">
                        <div class="promo-code-section">
                            <div class="promo-input-group">
                                <input type="text" id="promo-code" class="promo-input" placeholder="Enter promo code">
                                <button type="button" class="promo-btn" onclick="applyPromoCode()">Apply</button>
                            </div>
                            <div id="promo-message" class="promo-message"></div>
                        </div>
                        
                        <div class="summary-divider"></div>
                        
                        <div class="price-breakdown">
                            <div class="price-row">
                                <span>Subtotal:</span>
                                <span id="checkout-subtotal">Rs. 0.00</span>
                            </div>
                            <div id="discount-row" class="price-row discount-row" style="display: none;">
                                <span>Discount (<span id="discount-code"></span>):</span>
                                <span id="discount-amount">-Rs. 0.00</span>
                            </div>
                            <div class="price-row total-row">
                                <span>Total:</span>
                                <span id="checkout-total">Rs. 0.00</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Shop Page -->
    <section id="shop" class="page">
        <div class="container">
            <div class="shop-header">
                <h2>Shop All Products</h2>
                <div class="filter-section">
                    <div class="filter-dropdown">
                        <button class="filter-toggle" id="filter-toggle">
                            <span class="filter-icon">üîç</span>
                            <span class="filter-text">Filter by Category</span>
                            <span class="dropdown-arrow">‚ñº</span>
                        </button>
                        <div class="filter-dropdown-content" id="filter-dropdown-content">
                            <button class="filter-option active" data-category="all">
                                <span class="category-name">All Products</span>
                                <span class="category-count" id="count-all">0</span>
                            </button>
                            <div id="dynamic-categories">
                                <!-- Dynamic categories will be loaded here -->
                            </div>
                        </div>
                    </div>
                    <div class="active-filters" id="active-filters">
                        <span class="active-filter-label">Showing: <strong>All Products</strong></span>
                    </div>
                </div>
            </div>
            <div class="shop-results">
                <div id="shop-products" class="shop-products-grid">
                    <!-- Products will be displayed here -->
                </div>
                <div id="no-products" class="no-products" style="display: none;">
                    <p>No products found in this category.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Cart Page -->
    <section id="cart" class="page">
        <div class="container">
            <div class="cart-container">
                <h2>Shopping Cart</h2>
                <div id="cart-items" class="cart-items">
                    <!-- Cart items will be displayed here -->
                </div>
                <div id="cart-empty" class="cart-empty" style="display: none;">
                    <p>Your cart is empty</p>
                    <button class="form-button" onclick="showPage('home')">Continue Shopping</button>
                </div>
                <div id="cart-summary" class="cart-summary" style="display: none;">
                    <div class="summary-row">
                        <span>Total Items:</span>
                        <span id="total-items">0</span>
                    </div>
                    <div class="summary-row total-row">
                        <span>Total:</span>
                        <span id="total-price">Rs. 0.00</span>
                    </div>
                    <div class="cart-actions">
                        <button class="form-button" onclick="showPage('checkout')">Proceed to Checkout</button>
                        <button class="secondary-button" onclick="clearCart()">Clear Cart</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Product Details Page -->
    <section id="product-details" class="page">
        <div class="container">
            <div class="product-details-container">
                <div class="product-navigation">
                    <button class="back-btn" onclick="goBackToShop()">‚Üê Back to Shop</button>
                </div>
                
                <div class="product-main">
                    <div class="product-image-large">
                        <div id="product-main-image" class="main-product-image"></div>
                    </div>
                    
                    <div class="product-info">
                        <h1 id="product-title">Product Title</h1>
                        <div class="product-price-section">
                            <span id="product-price" class="product-price">Rs. 0.00</span>
                            <span id="product-original-price" class="original-price">Rs. 0.00</span>
                        </div>
                        
                        <div class="product-description">
                            <h3>Description</h3>
                            <p id="product-description-text">Product description will appear here.</p>
                        </div>
                        
                        
                        <div class="product-options">
                            <div class="size-selector">
                                <h4>Size</h4>
                                <div class="size-options">
                                    <button class="size-btn" data-size="S">S</button>
                                    <button class="size-btn active" data-size="M">M</button>
                                    <button class="size-btn" data-size="L">L</button>
                                    <button class="size-btn" data-size="XL">XL</button>
                                </div>
                            </div>
                            
                            <div class="quantity-selector">
                                <h4>Quantity</h4>
                                <div class="quantity-controls">
                                    <button class="quantity-btn" onclick="changeProductQuantity(-1)">-</button>
                                    <span id="product-quantity" class="quantity">1</span>
                                    <button class="quantity-btn" onclick="changeProductQuantity(1)">+</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="product-actions">
                            <button class="add-to-cart-btn" onclick="addProductToCart()">Add to Cart</button>
                            <button class="buy-now-btn" onclick="buyNow()">Buy Now</button>
                        </div>
                        
                        <div class="product-tags">
                            <div id="product-tags" class="tags"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Return Policy Page -->
    <section id="return-policy" class="page">
        <div class="container">
            <div class="policy-container">
                <h1>Return Policy</h1>
                <p class="policy-intro">Thank you for shopping with Trendyoft. If you are not entirely satisfied with your purchase, we're here to help.</p>
                
                <div class="policy-section">
                    <h2>30-Day Return Window</h2>
                    <p>You have <strong>30 calendar days</strong> to return an item from the date you received it. We believe this gives you ample time to try out your purchase and make sure it's perfect for you.</p>
                </div>
                
                <div class="policy-section">
                    <h2>Return Conditions</h2>
                    <p>To be eligible for a return, your item must be:</p>
                    <ul class="policy-list">
                        <li>Unused and in the same condition that you received it</li>
                        <li>In the original packaging</li>
                        <li>With all tags attached</li>
                        <li>Include proof of purchase (receipt or order confirmation)</li>
                    </ul>
                </div>
                
                <div class="policy-section">
                    <h2>How to Initiate a Return</h2>
                    <p>Starting a return is easy! Just follow these simple steps:</p>
                    <ol class="policy-steps">
                        <li><strong>Contact Us:</strong> Email our customer service team at <a href="mailto:support@trendyoft.com">support@trendyoft.com</a></li>
                        <li><strong>Provide Details:</strong> Include your order number and reason for return</li>
                        <li><strong>Get Return Label:</strong> We'll send you a prepaid return shipping label</li>
                        <li><strong>Pack & Ship:</strong> Pack your item securely and ship it back to us</li>
                        <li><strong>Receive Refund:</strong> Once we receive and inspect your return, we'll process your refund within 3-5 business days</li>
                    </ol>
                </div>
                
                <div class="policy-section">
                    <h2>Refund Processing</h2>
                    <p>Refunds will be processed to your original payment method. Please allow 3-5 business days for the refund to appear in your account after we process it.</p>
                </div>
                
                <div class="policy-section">
                    <h2>Questions?</h2>
                    <p>If you have any questions about returns or need assistance, don't hesitate to reach out to our friendly customer service team at <a href="mailto:support@trendyoft.com">support@trendyoft.com</a>. We're here to help!</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Reviews Page -->
    <section id="reviews" class="page">
        <div class="container">
            <div class="reviews-container">
                <h1>Customer Reviews</h1>
                <p class="reviews-intro">See what our customers are saying about their experience with Trendyoft!</p>
                
                <div class="reviews-list">
                    <div class="review-item">
                        <div class="review-header">
                            <div class="reviewer-name">Sarah M.</div>
                            <div class="review-rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                        </div>
                        <h3 class="review-title">Amazing quality and fast shipping!</h3>
                        <p class="review-text">"Great products and fast shipping! Loved the eco-friendly packaging. The quality exceeded my expectations and the customer service was top-notch!"</p>
                        <div class="review-date">Verified Purchase - January 2024</div>
                    </div>
                    
                    <div class="review-item">
                        <div class="review-header">
                            <div class="reviewer-name">Jane D.</div>
                            <div class="review-rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                        </div>
                        <h3 class="review-title">Excellent customer service!</h3>
                        <p class="review-text">"The customer service was very responsive and helpful. Had an issue with my order and they resolved it quickly! Will definitely shop here again."</p>
                        <div class="review-date">Verified Purchase - December 2023</div>
                    </div>
                    
                    <div class="review-item">
                        <div class="review-header">
                            <div class="reviewer-name">Mike R.</div>
                            <div class="review-rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                        </div>
                        <h3 class="review-title">Unique trending products!</h3>
                        <p class="review-text">"Found some amazing trending products here that I couldn't find anywhere else. The quality is top-notch and the prices are very reasonable!"</p>
                        <div class="review-date">Verified Purchase - November 2023</div>
                    </div>
                </div>

                <div class="review-form-section">
                    <h2>Leave a Review</h2>
                    <p>Share your experience with other customers!</p>
                    
                    <form class="review-form" id="review-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="reviewer-name">Your Name</label>
                                <input type="text" id="reviewer-name" name="reviewer-name" required>
                            </div>
                            <div class="form-group">
                                <label for="reviewer-email">Email Address</label>
                                <input type="email" id="reviewer-email" name="reviewer-email" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="rating">Rating</label>
                            <div class="star-rating">
                                <input type="radio" id="star5" name="rating" value="5" required>
                                <label for="star5">‚≠ê</label>
                                <input type="radio" id="star4" name="rating" value="4">
                                <label for="star4">‚≠ê</label>
                                <input type="radio" id="star3" name="rating" value="3">
                                <label for="star3">‚≠ê</label>
                                <input type="radio" id="star2" name="rating" value="2">
                                <label for="star2">‚≠ê</label>
                                <input type="radio" id="star1" name="rating" value="1">
                                <label for="star1">‚≠ê</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="review-title">Review Title</label>
                            <input type="text" id="review-title" name="review-title" placeholder="Sum up your experience..." required>
                        </div>
                        
                        <div class="form-group">
                            <label for="review-text">Your Review</label>
                            <textarea id="review-text" name="review-text" rows="5" placeholder="Tell us about your experience with our products and service..." required></textarea>
                        </div>
                        
                        <button type="submit" class="form-button">Submit Review</button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Order Placed Page -->
    <section id="order-placed" class="page">
        <div class="container">
            <div class="success-container">
                <div class="success-icon">‚úì</div>
                <h2>Order Placed Successfully!</h2>
                <p>Thank you for your purchase. Your order has been confirmed.</p>
                
                <div class="order-details">
                    <h3>Order Details</h3>
                    <div class="order-info">
                        <div class="info-row">
                            <span class="label">Order Number:</span>
                            <span class="value">#TRD-2024-001</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Estimated Delivery:</span>
                            <span class="value">3-5 business days</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Total Amount:</span>
                            <span class="value">Rs. 39.98</span>
                        </div>
                    </div>
                </div>

                <div class="order-actions">
                    <button class="form-button" onclick="showPage('home')">Continue Shopping</button>
                    <button class="secondary-button">Track Order</button>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Cart functionality
        let cart = [];
        
        // Backend API Configuration
        const API_BASE_URL = 'http://localhost:8000';
        
        // Function to fetch products from backend API
        async function fetchProductsFromAPI() {
            try {
                const response = await fetch(`${API_BASE_URL}/products/`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const apiProducts = await response.json();
                
                // Transform API data to match frontend format
                return apiProducts.map(product => {
                    // Determine tags based on product name and category
                    let tags = [];
                    
                    // Trending items - Adventure and Mountain themed
                    if (product.title.toLowerCase().includes('adventure') || product.title.toLowerCase().includes('mountain')) {
                        tags.push('trending');
                    }
                    
                    // New arrivals - Striped and Coral items
                    if (product.title.toLowerCase().includes('striped') || product.title.toLowerCase().includes('coral')) {
                        tags.push('new-arrivals');
                    }
                    
                    // Sale items - Forest and Green themed
                    if (product.title.toLowerCase().includes('forest') || product.title.toLowerCase().includes('green')) {
                        tags.push('sale');
                    }
                    
                    // Add base category to tags for easier filtering
                    tags.push(product.category);
                    
                    return {
                        id: product.id,
                        name: product.title,
                        price: product.price,
                        category: product.category,
                        tags: tags,
                        image: getProductImageClass(product.title), // Use existing image classes
                        imageUrl: `${API_BASE_URL}${product.image_url}`, // Backend image URL
                        description: product.description,
                        quantity: product.quantity
                    };
                });
            } catch (error) {
                console.error('Error fetching products from API:', error);
                // Fallback to static products if API fails
                return getStaticProducts();
            }
        }
        
        // Helper function to get image class based on product name
        function getProductImageClass(productName) {
            if (productName.toLowerCase().includes('striped')) return 'product-1';
            if (productName.toLowerCase().includes('mountain')) return 'product-2';
            if (productName.toLowerCase().includes('forest')) return 'product-3';
            if (productName.toLowerCase().includes('coral')) return 'product-4';
            return 'product-1'; // Default
        }
        
        // Fallback static products (in case API is not available)
        function getStaticProducts() {
            return [
                {
                    id: 'static-1',
                    name: 'Striped Adventure Tee',
                    price: 19.99,
                    category: 't-shirts',
                    tags: ['trending', 't-shirts'],
                    image: 'product-1',
                    description: 'Perfect for outdoor adventures with its comfortable striped design.'
                },
                {
                    id: 'static-2',
                    name: 'Mountain Sunset Shirt',
                    price: 19.99,
                    category: 'shirts',
                    tags: ['trending', 'shirts'],
                    image: 'product-2',
                    description: 'Inspired by beautiful mountain sunsets, this shirt combines style with functionality.'
                },
                {
                    id: 'static-3',
                    name: 'Forest Green Classic',
                    price: 19.99,
                    category: 't-shirts',
                    tags: ['sale', 't-shirts'],
                    image: 'product-3',
                    description: 'A timeless forest green design that never goes out of style.'
                },
                {
                    id: 'static-4',
                    name: 'Coral Comfort Tee',
                    price: 19.99,
                    category: 't-shirts',
                    tags: ['new-arrivals', 't-shirts'],
                    image: 'product-4',
                    description: 'Vibrant coral color that brightens any wardrobe.'
                }
            ];
        }

        
        // Get products dynamically
        let products = [];
        let shopInitialized = false;
        let categoriesData = [];
        
        // Initialize products after DOM is loaded
        document.addEventListener('DOMContentLoaded', async function() {
            // Show loading state
            showLoadingState();
            
            // Fetch products from API
            products = await fetchProductsFromAPI();
            
            // Fetch categories from API
            await fetchAndUpdateCategories();
            
            // Update homepage with API products
            updateHomepageProducts();
            
            // Initialize filter functionality
            initializeFilterDropdown();
            
            // Hide loading state
            hideLoadingState();
            
            // Add Enter key support for promo code
            document.getElementById('promo-code').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    applyPromoCode();
                }
            });
        });
        
        // Product scrolling functionality
        function scrollProducts(direction) {
            const container = document.getElementById('products-grid');
            const scrollAmount = 320; // Width of one product card + gap
            
            if (direction === 'left') {
                container.scrollBy({
                    left: -scrollAmount,
                    behavior: 'smooth'
                });
            } else {
                container.scrollBy({
                    left: scrollAmount,
                    behavior: 'smooth'
                });
            }
        }
        
        // Auto-scroll functionality (optional)
        function startAutoScroll() {
            const container = document.getElementById('products-grid');
            if (!container) return;
            
            setInterval(() => {
                const maxScroll = container.scrollWidth - container.clientWidth;
                const currentScroll = container.scrollLeft;
                
                if (currentScroll >= maxScroll) {
                    // Reset to beginning
                    container.scrollTo({
                        left: 0,
                        behavior: 'smooth'
                    });
                } else {
                    // Scroll to next product
                    scrollProducts('right');
                }
            }, 5000); // Auto-scroll every 5 seconds
        }
        
        // Initialize auto-scroll when homepage is loaded
        function initializeAutoScroll() {
            // Uncomment the line below if you want auto-scrolling
            // startAutoScroll();
        }
        
        // Loading state functions
        function showLoadingState() {
            const productsGrid = document.querySelector('.products-grid');
            if (productsGrid) {
                productsGrid.innerHTML = `
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p>Loading products...</p>
                    </div>
                `;
            }
        }
        
        function hideLoadingState() {
            // Loading will be replaced by actual products
        }
        
        // Update homepage products with API data
        function updateHomepageProducts() {
            const productsGrid = document.querySelector('.products-grid');
            if (!productsGrid || products.length === 0) return;
            
            // Show all products from API
            const productsHTML = products.map(product => `
                <div class="product-card">
                    <div class="product-image ${product.image}" onclick="viewProductDetails('${product.name}')" style="background-image: url('${product.imageUrl || ''}')"></div>
                    <h3 onclick="viewProductDetails('${product.name}')">${product.name}</h3>
                    <p class="price">Rs. ${product.price.toFixed(2)}</p>
                    <button class="add-to-cart" onclick="addToCartFromHome('${product.name}', ${product.price})">Add to Cart</button>
                </div>
            `).join('');
            
            productsGrid.innerHTML = productsHTML;
        }
        
        // Add to cart from homepage
        function addToCartFromHome(productName, price) {
            addToCart(productName, price);
            
            // Find the button and show feedback
            const buttons = document.querySelectorAll('.add-to-cart');
            buttons.forEach(button => {
                const card = button.closest('.product-card');
                const cardTitle = card.querySelector('h3').textContent;
                
                if (cardTitle === productName) {
                    const originalText = button.textContent;
                    button.textContent = 'Added!';
                    button.style.background = '#10b981';
                    
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.style.background = '';
                    }, 2000);
                }
            });
        }
        
        // Initialize shop page
        function initializeShopPage() {
            // Reset filter options
            const filterOptions = document.querySelectorAll('.filter-option');
            filterOptions.forEach(opt => opt.classList.remove('active'));
            
            // Set "All Products" as active
            const allProductsOption = document.querySelector('.filter-option[data-category="all"]');
            if (allProductsOption) {
                allProductsOption.classList.add('active');
            }
            
            // Reset active filter display
            const activeFilterLabel = document.querySelector('.active-filter-label');
            if (activeFilterLabel) {
                activeFilterLabel.innerHTML = 'Showing: <strong>All Products</strong>';
            }
            
            // Refresh categories in case new ones were added
            fetchAndUpdateCategories();
            
            displayProducts('all');
        }
        
        // Fetch categories from API
        async function fetchAndUpdateCategories() {
            try {
                const response = await fetch(`${API_BASE_URL}/categories/`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                categoriesData = data.categories || [];
                updateCategoryDropdown();
            } catch (error) {
                console.error('Error fetching categories:', error);
                // Fallback to static categories
                categoriesData = [
                    { name: 't-shirts', count: 0 },
                    { name: 'shirts', count: 0 }
                ];
                updateCategoryDropdown();
            }
        }
        
        // Update category dropdown with fetched data
        function updateCategoryDropdown() {
            const dynamicCategories = document.getElementById('dynamic-categories');
            const allProductsCount = document.getElementById('count-all');
            
            // Update "All Products" count
            const totalCount = categoriesData.reduce((sum, cat) => sum + cat.count, 0);
            allProductsCount.textContent = totalCount;
            
            // Clear existing categories
            dynamicCategories.innerHTML = '';
            
            // Add categories from API
            categoriesData.forEach(category => {
                const categoryButton = document.createElement('button');
                categoryButton.className = 'filter-option';
                categoryButton.setAttribute('data-category', category.name.toLowerCase());
                categoryButton.innerHTML = `
                    <span class="category-name">${category.name}</span>
                    <span class="category-count">${category.count}</span>
                `;
                dynamicCategories.appendChild(categoryButton);
            });
        }
        
        // Initialize filter dropdown functionality
        function initializeFilterDropdown() {
            const filterToggle = document.getElementById('filter-toggle');
            const filterDropdown = document.getElementById('filter-dropdown-content');
            const activeFilters = document.getElementById('active-filters');
            
            // Toggle dropdown
            filterToggle.addEventListener('click', function(e) {
                e.stopPropagation();
                filterDropdown.classList.toggle('show');
                filterToggle.classList.toggle('active');
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!filterToggle.contains(e.target) && !filterDropdown.contains(e.target)) {
                    filterDropdown.classList.remove('show');
                    filterToggle.classList.remove('active');
                }
            });
            
            // Handle filter option clicks
            filterDropdown.addEventListener('click', function(e) {
                if (e.target.closest('.filter-option')) {
                    const option = e.target.closest('.filter-option');
                    const category = option.getAttribute('data-category');
                    const categoryName = option.querySelector('.category-name').textContent;
                    
                    // Update active filter
                    document.querySelectorAll('.filter-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    option.classList.add('active');
                    
                    // Update active filter display
                    const activeFilterLabel = activeFilters.querySelector('.active-filter-label');
                    activeFilterLabel.innerHTML = `Showing: <strong>${categoryName}</strong>`;
                    
                    // Filter products
                    displayProducts(category);
                    
                    // Close dropdown
                    filterDropdown.classList.remove('show');
                    filterToggle.classList.remove('active');
                }
            });
        }
        
        // Display products based on category
        function displayProducts(category) {
            const shopProductsGrid = document.getElementById('shop-products');
            const noProductsDiv = document.getElementById('no-products');
            
            // Show loading spinner
            shopProductsGrid.innerHTML = `
                <div class="loading-spinner">
                    <div class="spinner"></div>
                </div>
            `;
            
            // Simulate loading delay for better UX
            setTimeout(() => {
                let filteredProducts = [];
                
                if (category === 'all') {
                    filteredProducts = products;
                } else {
                    filteredProducts = products.filter(product => {
                        return product.category === category || product.tags.includes(category);
                    });
                }
                
                if (filteredProducts.length === 0) {
                    shopProductsGrid.innerHTML = '';
                    noProductsDiv.style.display = 'block';
                    noProductsDiv.innerHTML = `
                        <p>No products found in this category.</p>
                        <p>Try selecting a different category from the filters above.</p>
                    `;
                } else {
                    noProductsDiv.style.display = 'none';
                    
                    const productsHTML = filteredProducts.map(product => `
                        <div class="product-card">
                            <div class="product-image ${product.image}" onclick="viewProductDetails('${product.name}')" style="background-image: url('${product.imageUrl || ''}')"></div>
                            <h3 onclick="viewProductDetails('${product.name}')">${product.name}</h3>
                            <p class="price">Rs. ${product.price.toFixed(2)}</p>
                            <button class="add-to-cart" onclick="addToCartFromShop('${product.name}', ${product.price})">
                                Add to Cart
                            </button>
                        </div>
                    `).join('');
                    
                    shopProductsGrid.innerHTML = productsHTML;
                }
            }, 300);
        }
        
        // Add to cart from shop page with animation
        function addToCartFromShop(productName, price) {
            addToCart(productName, price);
            
            // Find the button that was clicked
            const buttons = document.querySelectorAll('.add-to-cart');
            buttons.forEach(button => {
                if (button.textContent.trim() === 'Add to Cart') {
                    const productCard = button.closest('.product-card');
                    const cardProductName = productCard.querySelector('h3').textContent;
                    
                    if (cardProductName === productName) {
                        button.textContent = 'Added!';
                        button.style.background = '#10b981';
                        button.style.transform = 'scale(0.95)';
                        
                        setTimeout(() => {
                            button.textContent = 'Add to Cart';
                            button.style.background = '';
                            button.style.transform = '';
                        }, 2000);
                    }
                }
            });
        }
        
        // Navigation functionality
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Update navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            const activeLink = document.querySelector(`[data-page="${pageId}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
            
            // Update cart display when cart page is shown
            if (pageId === 'cart') {
                updateCartDisplay();
            }
            
            // Update shop display when shop page is shown
            if (pageId === 'shop') {
                if (products.length === 0) {
                    products = getProductsFromDOM();
                }
                initializeShopPage();
            }
            
            // Update checkout display when checkout page is shown
            if (pageId === 'checkout') {
                updateCheckoutDisplay();
            }
        }

        // Add click event listeners to navigation links
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const pageId = link.getAttribute('data-page');
                showPage(pageId);
            });
        });

        // Handle product click to view details
        function viewProductDetails(productName) {
            const product = products.find(p => p.name === productName);
            if (product) {
                currentProduct = product;
                
                // Set main image
                document.getElementById('product-main-image').className = `main-product-image ${product.image}`;
                
                // Set product info
                document.getElementById('product-title').textContent = product.name;
                document.getElementById('product-price').textContent = `Rs. ${product.price.toFixed(2)}`;
                
                // Use API description or fallback
                const productDescription = product.description || `Discover the exceptional quality of ${product.name}. Crafted with premium materials for ultimate comfort and style.`;
                document.getElementById('product-description-text').textContent = productDescription;
                
                // Update product image if API provides image URL
                if (product.imageUrl) {
                    const productImage = document.getElementById('product-main-image');
                    productImage.style.backgroundImage = `url('${product.imageUrl}')`;
                    productImage.style.backgroundSize = 'cover';
                    productImage.style.backgroundPosition = 'center';
                }
                
                // Set tags
                const tagsContainer = document.getElementById('product-tags');
                tagsContainer.innerHTML = product.tags.map(tag => 
                    `<span class="tag">${tag.replace('-', ' ').toUpperCase()}</span>`
                ).join('');
                
                // Show/hide size selector based on category
                const sizeSelector = document.querySelector('.size-selector');
                const isClothing = product.category === 't-shirts' || product.category === 'shirts' || 
                                  product.name.toLowerCase().includes('tee') || 
                                  product.name.toLowerCase().includes('shirt');
                
                if (isClothing) {
                    sizeSelector.style.display = 'block';
                } else {
                    sizeSelector.style.display = 'none';
                }
                
                // Initialize product details page
                initializeProductDetails();
                
                showPage('product-details');
            }
        }

        // Go back to shop from product page
        function goBackToShop() {
            showPage('shop');
        }
        
        // Product details page variables
        let currentProduct = null;
        let selectedSize = 'M';
        let productQuantity = 1;
        
        // Initialize product details page
        function initializeProductDetails() {
            // Size selector
            const sizeButtons = document.querySelectorAll('.size-btn');
            sizeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    sizeButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    selectedSize = this.getAttribute('data-size');
                });
            });
            
            // Reset quantity
            productQuantity = 1;
            document.getElementById('product-quantity').textContent = productQuantity;
        }
        
        // Change product quantity
        function changeProductQuantity(change) {
            productQuantity += change;
            if (productQuantity < 1) productQuantity = 1;
            if (productQuantity > 10) productQuantity = 10;
            document.getElementById('product-quantity').textContent = productQuantity;
        }
        
        // Add product to cart from details page
        function addProductToCart() {
            if (currentProduct) {
                for (let i = 0; i < productQuantity; i++) {
                    addToCart(currentProduct.name, currentProduct.price);
                }
                
                // Show success message
                const addBtn = document.querySelector('.add-to-cart-btn');
                const originalText = addBtn.textContent;
                addBtn.textContent = `Added ${productQuantity} to Cart!`;
                addBtn.style.background = '#10b981';
                
                setTimeout(() => {
                    addBtn.textContent = originalText;
                    addBtn.style.background = '';
                }, 2000);
            }
        }
        
        // Buy now functionality
        function buyNow() {
            if (currentProduct) {
                // Clear cart first
                cart = [];
                
                // Add current product to cart
                for (let i = 0; i < productQuantity; i++) {
                    addToCart(currentProduct.name, currentProduct.price);
                }
                
                // Go to checkout
                showPage('checkout');
            }
        }

        // Handle checkout form submission
        function placeOrder(event) {
            event.preventDefault();
            
            // Check if cart is empty
            if (cart.length === 0) {
                alert('Your cart is empty. Please add items to your cart before placing an order.');
                return;
            }
            
            // Get all required form fields
            const requiredFields = [
                { id: 'firstName', name: 'First Name' },
                { id: 'lastName', name: 'Last Name' },
                { id: 'email', name: 'Email Address' },
                { id: 'phoneNumber', name: 'Phone Number' },
                { id: 'address', name: 'Address' },
                { id: 'city', name: 'City' },
                { id: 'country', name: 'Country/Region' },
                { id: 'zipCode', name: 'ZIP/Postal Code' },
                { id: 'cardNumber', name: 'Card Number' },
                { id: 'expiryDate', name: 'Expiry Date' },
                { id: 'cvv', name: 'CVV' }
            ];
            
            // Check if all required fields are filled
            const emptyFields = [];
            for (const field of requiredFields) {
                const element = document.getElementById(field.id);
                if (!element || !element.value.trim()) {
                    emptyFields.push(field.name);
                }
            }
            
            // If there are empty fields, show error message
            if (emptyFields.length > 0) {
                alert(`Please fill in the following required fields:\n\n${emptyFields.join('\n')}`);
                return;
            }
            
            // Validate email format
            const emailField = document.getElementById('email');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(emailField.value)) {
                alert('Please enter a valid email address.');
                emailField.focus();
                return;
            }
            
            // Validate phone number (basic validation)
            const phoneField = document.getElementById('phoneNumber');
            const phoneRegex = /^[+]?[\d\s\-\(\)]{10,}$/;
            if (!phoneRegex.test(phoneField.value)) {
                alert('Please enter a valid phone number (at least 10 digits).');
                phoneField.focus();
                return;
            }
            
            // Validate credit card number (basic validation - just check if it's numbers and has 13-19 digits)
            const cardNumber = document.getElementById('cardNumber').value.replace(/\s/g, '');
            if (!/^\d{13,19}$/.test(cardNumber)) {
                alert('Please enter a valid credit card number (13-19 digits).');
                document.getElementById('cardNumber').focus();
                return;
            }
            
            // Validate expiry date (MM/YY format)
            const expiryDate = document.getElementById('expiryDate').value;
            const expiryRegex = /^(0[1-9]|1[0-2])\/\d{2}$/;
            if (!expiryRegex.test(expiryDate)) {
                alert('Please enter a valid expiry date in MM/YY format.');
                document.getElementById('expiryDate').focus();
                return;
            }
            
            // Validate CVV (3-4 digits)
            const cvv = document.getElementById('cvv').value;
            if (!/^\d{3,4}$/.test(cvv)) {
                alert('Please enter a valid CVV (3-4 digits).');
                document.getElementById('cvv').focus();
                return;
            }
            
            // If all validations pass, proceed with order
            showPage('order-placed');
        }

        // Add to cart functionality
        function addToCart(productName, price) {
            const existingItem = cart.find(item => item.name === productName);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    name: productName,
                    price: price,
                    quantity: 1
                });
            }
            
            updateCartCount();
        }
        
        // Update cart count in navbar
        function updateCartCount() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cart-count').textContent = totalItems;
        }
        
        // Update cart display
        function updateCartDisplay() {
            const cartItems = document.getElementById('cart-items');
            const cartEmpty = document.getElementById('cart-empty');
            const cartSummary = document.getElementById('cart-summary');
            
            if (cart.length === 0) {
                cartItems.style.display = 'none';
                cartEmpty.style.display = 'block';
                cartSummary.style.display = 'none';
            } else {
                cartItems.style.display = 'block';
                cartEmpty.style.display = 'none';
                cartSummary.style.display = 'block';
                
                // Clear existing items
                cartItems.innerHTML = '';
                
                // Add cart items
                cart.forEach((item, index) => {
                    const cartItem = document.createElement('div');
                    cartItem.className = 'cart-item';
                    cartItem.innerHTML = `
                        <div class="item-info">
                            <h4>${item.name}</h4>
                            <p class="item-price">Rs. ${item.price}</p>
                        </div>
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="changeQuantity(${index}, -1)">-</button>
                            <span class="quantity">${item.quantity}</span>
                            <button class="quantity-btn" onclick="changeQuantity(${index}, 1)">+</button>
                        </div>
                        <div class="item-total">
                            Rs. ${(item.price * item.quantity).toFixed(2)}
                        </div>
                        <button class="remove-btn" onclick="removeItem(${index})">√ó</button>
                    `;
                    cartItems.appendChild(cartItem);
                });
                
                // Update totals
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                
                document.getElementById('total-items').textContent = totalItems;
                document.getElementById('total-price').textContent = `Rs. ${totalPrice.toFixed(2)}`;
            }
        }
        
        // Change quantity of item
        function changeQuantity(index, change) {
            cart[index].quantity += change;
            
            if (cart[index].quantity <= 0) {
                cart.splice(index, 1);
            }
            
            updateCartCount();
            updateCartDisplay();
        }
        
        // Remove item from cart
        function removeItem(index) {
            cart.splice(index, 1);
            updateCartCount();
            updateCartDisplay();
        }
        
        // Clear entire cart
        function clearCart() {
            cart = [];
            updateCartCount();
            updateCartDisplay();
        }
        
        // Promo code variables
        let appliedPromoCode = null;
        let promoDiscount = 0;
        
        // Available promo codes
        const promoCodes = {
            'SAVE10': { type: 'percentage', value: 10, description: '10% off' },
            'SAVE20': { type: 'percentage', value: 20, description: '20% off' },
            'FLAT50': { type: 'fixed', value: 50, description: 'Rs. 50 off' },
            'FLAT100': { type: 'fixed', value: 100, description: 'Rs. 100 off' },
            'WELCOME': { type: 'percentage', value: 15, description: '15% off for new customers' },
            'TRENDY25': { type: 'percentage', value: 25, description: '25% off limited time' }
        };
        
        // Apply promo code
        function applyPromoCode() {
            const promoInput = document.getElementById('promo-code');
            const promoMessage = document.getElementById('promo-message');
            const promoCodeEntered = promoInput.value.trim().toUpperCase();
            
            if (!promoCodeEntered) {
                showPromoMessage('Please enter a promo code', 'error');
                return;
            }
            
            if (promoCodes[promoCodeEntered]) {
                const promo = promoCodes[promoCodeEntered];
                appliedPromoCode = promoCodeEntered;
                
                // Calculate discount
                const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                if (promo.type === 'percentage') {
                    promoDiscount = (subtotal * promo.value) / 100;
                } else {
                    promoDiscount = Math.min(promo.value, subtotal); // Don't exceed subtotal
                }
                
                showPromoMessage(`Promo code applied! ${promo.description}`, 'success');
                updateCheckoutPricing();
                
                // Disable input and button
                promoInput.disabled = true;
                document.querySelector('.promo-btn').textContent = 'Applied';
                document.querySelector('.promo-btn').disabled = true;
                
            } else {
                showPromoMessage('Invalid promo code', 'error');
            }
        }
        
        // Show promo message
        function showPromoMessage(message, type) {
            const promoMessage = document.getElementById('promo-message');
            promoMessage.textContent = message;
            promoMessage.className = `promo-message ${type}`;
            promoMessage.style.display = 'block';
        }
        
        // Reset promo code
        function resetPromoCode() {
            appliedPromoCode = null;
            promoDiscount = 0;
            
            const promoInput = document.getElementById('promo-code');
            const promoMessage = document.getElementById('promo-message');
            const promoBtn = document.querySelector('.promo-btn');
            
            promoInput.value = '';
            promoInput.disabled = false;
            promoBtn.textContent = 'Apply';
            promoBtn.disabled = false;
            promoMessage.style.display = 'none';
            
            document.getElementById('discount-row').style.display = 'none';
        }
        
        // Update checkout pricing
        function updateCheckoutPricing() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const total = subtotal - promoDiscount;
            
            document.getElementById('checkout-subtotal').textContent = `Rs. ${subtotal.toFixed(2)}`;
            document.getElementById('checkout-total').textContent = `Rs. ${total.toFixed(2)}`;
            
            if (appliedPromoCode && promoDiscount > 0) {
                document.getElementById('discount-row').style.display = 'flex';
                document.getElementById('discount-code').textContent = appliedPromoCode;
                document.getElementById('discount-amount').textContent = `-Rs. ${promoDiscount.toFixed(2)}`;
            } else {
                document.getElementById('discount-row').style.display = 'none';
            }
        }
        
        // Update checkout display
        function updateCheckoutDisplay() {
            const checkoutItems = document.getElementById('checkout-items');
            const checkoutEmpty = document.getElementById('checkout-empty');
            const checkoutSummary = document.getElementById('checkout-summary');
            
            if (cart.length === 0) {
                checkoutItems.style.display = 'none';
                checkoutEmpty.style.display = 'block';
                checkoutSummary.style.display = 'none';
                resetPromoCode();
            } else {
                checkoutItems.style.display = 'block';
                checkoutEmpty.style.display = 'none';
                checkoutSummary.style.display = 'block';
                
                // Clear existing items
                checkoutItems.innerHTML = '';
                
                // Add checkout items
                cart.forEach(item => {
                    const checkoutItem = document.createElement('div');
                    checkoutItem.className = 'summary-item';
                    checkoutItem.innerHTML = `
                        <div class="item-details">
                            <span class="item-name">${item.name}</span>
                            <span class="item-quantity">x${item.quantity}</span>
                        </div>
                        <span class="item-price">Rs. ${(item.price * item.quantity).toFixed(2)}</span>
                    `;
                    checkoutItems.appendChild(checkoutItem);
                });
                
                // Update pricing
                updateCheckoutPricing();
            }
        }

        // Search functionality
        function toggleSearch() {
            const searchModal = document.getElementById('search-modal');
            const searchInput = document.getElementById('search-input');
            
            if (searchModal.style.display === 'flex') {
                searchModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            } else {
                searchModal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
                setTimeout(() => searchInput.focus(), 100);
                showSearchSuggestions();
            }
        }
        
        function showSearchSuggestions() {
            const searchResults = document.getElementById('search-results');
            searchResults.innerHTML = `
                <div class="search-suggestions">
                    <p>Try searching for: "Striped", "Mountain", "Green", "Coral"</p>
                </div>
            `;
        }
        
        async function searchProducts(query) {
            if (!query.trim()) {
                showSearchSuggestions();
                return;
            }
            
            try {
                // Try to search using API first
                const response = await fetch(`${API_BASE_URL}/search/?q=${encodeURIComponent(query)}`);
                if (response.ok) {
                    const apiResults = await response.json();
                    // Transform API results to match frontend format
                    const transformedResults = apiResults.map(product => ({
                        id: product.id,
                        name: product.title,
                        price: product.price,
                        category: product.category,
                        image: getProductImageClass(product.title),
                        imageUrl: `${API_BASE_URL}${product.image_url}`,
                        description: product.description
                    }));
                    displaySearchResults(transformedResults, query);
                } else {
                    // Fallback to local search
                    const filteredProducts = products.filter(product => 
                        product.name.toLowerCase().includes(query.toLowerCase()) ||
                        product.category.toLowerCase().includes(query.toLowerCase())
                    );
                    displaySearchResults(filteredProducts, query);
                }
            } catch (error) {
                console.error('Search API error:', error);
                // Fallback to local search
                const filteredProducts = products.filter(product => 
                    product.name.toLowerCase().includes(query.toLowerCase()) ||
                    product.category.toLowerCase().includes(query.toLowerCase())
                );
                displaySearchResults(filteredProducts, query);
            }
        }
        
        function displaySearchResults(results, query) {
            const searchResults = document.getElementById('search-results');
            
            if (results.length === 0) {
                searchResults.innerHTML = `
                    <div class="no-results">
                        <p>No products found for "${query}"</p>
                        <p>Try searching for: "Striped", "Mountain", "Green", "Coral"</p>
                    </div>
                `;
                return;
            }
            
            const resultsHTML = results.map(product => `
                <div class="search-result-item" onclick="selectProduct('${product.name}', ${product.price})">
                    <div class="result-image" style="background-image: url('${product.imageUrl || ''}'); width: 50px; height: 50px; background-size: cover; background-position: center; border-radius: 4px; margin-right: 1rem;"></div>
                    <div class="result-info">
                        <h4>${product.name}</h4>
                        <p class="result-price">Rs. ${product.price.toFixed(2)}</p>
                    </div>
                    <button class="result-add-btn">Add to Cart</button>
                </div>
            `).join('');
            
            searchResults.innerHTML = `
                <div class="search-results-header">
                    <p>Found ${results.length} product${results.length > 1 ? 's' : ''} for "${query}"</p>
                </div>
                <div class="search-results-list">
                    ${resultsHTML}
                </div>
            `;
        }
        
        function selectProduct(productName, price) {
            addToCart(productName, price);
            
            // Show success message
            const searchResults = document.getElementById('search-results');
            const successMessage = document.createElement('div');
            successMessage.className = 'search-success';
            successMessage.innerHTML = `
                <p>‚úì ${productName} added to cart!</p>
            `;
            searchResults.appendChild(successMessage);
            
            setTimeout(() => {
                successMessage.remove();
            }, 2000);
        }
        
        // Search input event listener
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('search-input');
            
            searchInput.addEventListener('input', function(e) {
                searchProducts(e.target.value);
            });
            
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const results = document.querySelectorAll('.search-result-item');
                    if (results.length > 0) {
                        results[0].click();
                    }
                }
            });
        });
        
        // Close search modal when clicking outside
        document.addEventListener('click', function(e) {
            const searchModal = document.getElementById('search-modal');
            const searchBtn = document.querySelector('.search-btn');
            
            if (e.target === searchModal && !searchBtn.contains(e.target)) {
                toggleSearch();
            }
        });
        
        // Close search modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const searchModal = document.getElementById('search-modal');
                if (searchModal.style.display === 'flex') {
                    toggleSearch();
                }
            }
        });

        // Add to cart functionality with product details
        document.querySelectorAll('.add-to-cart').forEach(button => {
            button.addEventListener('click', (e) => {
                const productCard = e.target.closest('.product-card');
                const productName = productCard.querySelector('h3').textContent;
                const productPrice = parseFloat(productCard.querySelector('.price').textContent.replace('Rs. ', ''));
                
                addToCart(productName, productPrice);
                
                button.textContent = 'Added!';
                button.style.background = '#10b981';
                setTimeout(() => {
                    button.textContent = 'Add to Cart';
                    button.style.background = '';
                }, 2000);
            });
        });
        
        // Review form functionality
        document.getElementById('review-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form data
            const formData = new FormData(this);
            const reviewData = {
                name: formData.get('reviewer-name'),
                email: formData.get('reviewer-email'),
                rating: formData.get('rating'),
                title: formData.get('review-title'),
                text: formData.get('review-text')
            };
            
            // Here you would normally send to your backend
            console.log('Review submitted:', reviewData);
            
            // Show success message
            alert('Thank you for your review! We appreciate your feedback.');
            
            // Reset form
            this.reset();
        });
    </script>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Navigation</h3>
                    <ul class="footer-links">
                        <li><a href="#" onclick="showPage('home')">Home</a></li>
                        <li><a href="#" onclick="showPage('shop')">Shop All Products</a></li>
                        <li><a href="#" onclick="showPage('return-policy')">Return Policy</a></li>
                        <li><a href="#" onclick="showPage('reviews')">Reviews</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Contact Us</h3>
                    <div class="contact-info">
                        <p><strong>Trendyoft Inc.</strong></p>
                        <p>Email: <a href="mailto:support@trendyoft.com">support@trendyoft.com</a></p>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Follow Us</h3>
                    <div class="social-links">
                        <a href="https://instagram.com" target="_blank" rel="noopener noreferrer">
                            <span class="social-icon">üì∑</span> Instagram
                        </a>
                        <a href="https://facebook.com" target="_blank" rel="noopener noreferrer">
                            <span class="social-icon">üìò</span> Facebook
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="brand-message">
                    <p><em>"We curate the internet's most viral, useful, and just plain fun products ‚Äî delivered to your door."</em></p>
                </div>
                <div class="footer-legal">
                    <p>&copy; 2024 Trendyoft Inc. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

</body>
</html>
